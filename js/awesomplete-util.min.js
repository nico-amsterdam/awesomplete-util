// AwesompleteUtil - Nico Hoogervorst - MIT license
var AwesompleteUtil=function(){var t="awesomplete-",n=t+"loadcomplete",e=t+"close",r=t+"match",i=t+"prepop",u=t+"select",o="awe-found",a="awe-not-found",c=Awesomplete.$;function f(t,n,e){return c.fire(t,n,{detail:e})}function l(t,n){var e,u,c,l,s,d,p=t.input,h=p.classList,m=t.utilprops,v=m.selected,b=m.convertInput.call(t,p.value),y=t.opened,w=[],A=t._list;if(m.prepop=!1,A){for(l=0;l<A.length;l++)if(c=A[l],s=t.data(c,b),d=void 0,e={label:(d=Array.isArray(s)?{label:s[0],value:s[1]}:"object"==typeof s&&"label"in s&&"value"in s?s:{label:s,value:s}).label||d.value,value:d.value},0===t.maxItems&&(e.toString=function(){return""+this.label},t.filter(e,b)&&(y=!0)),u={input:{value:""}},t.replace.call(u,e),m.convertInput.call(t,u.input.value)===b){if(v&&v.value===e.value&&v.label===e.label){w=[c];break}w.push(c)}m.prevSelected!==w&&(w.length>0?n?f(p,i,w):m.changed&&(m.prevSelected=w,h.remove(a),h.add(o),f(p,r,w)):n?f(p,i,[]):m.changed&&(m.prevSelected=[],h.remove(o),y&&p===document.activeElement?h.remove(a):""!==b&&(h.add(a),f(p,r,[]))))}}function s(t){var r=this;t.type!==e&&t.type!==n&&"blur"!==t.type||t.target!==r.input||l(r,r.utilprops.prepop&&t.type===n)}function d(t){t.target===this.input&&9===t.keyCode&&this.select(void 0,void 0,t)}function p(t){var n=this;clearTimeout(n.utilprops.timeoutID),n.utilprops.changed=!0,n.utilprops.selected=t.text}function h(t,n,e){var r=t.utilprops;return!r.t||!r.loadall&&0===n.lastIndexOf(e,0)&&(0!==n.lastIndexOf(r.t,0)||"number"==typeof r.limit&&t._list.length>=r.limit)}function m(t,e,r){t.list=e,t.utilprops.t=r,f(t.input,n,r)}function v(){var t,n,e=this,r=e.i,i=e.u,u=e.queryVal,o=r.utilprops.val;if(200===i.status){if(t=JSON.parse(i.responseText),r.utilprops.convertResponse&&(t=r.utilprops.convertResponse(t)),!Array.isArray(t))if(0===r.utilprops.limit||1===r.utilprops.limit)t=function(t){return 0===Object.keys(t).length&&t.constructor===Object}(t)?[]:[t];else for(n in t)if(Array.isArray(t[n])){t=t[n];break}Array.isArray(t)&&h(r,o,u)&&m(r,t,u||r.utilprops.loadall)}}function b(t,n){var e=new XMLHttpRequest;t.utilprops.ajax.call(t,t.utilprops.url,t.utilprops.urlEnd,t.utilprops.loadall?"":n,v.bind({i:t,u:e,queryVal:n}),e)}function y(t,n,e){t.utilprops.url&&h(t,n,n)?"number"==typeof e&&e>0?t.utilprops.timeoutID=setTimeout(b.bind(null,t,n),e):b(t,n):l(t,t.utilprops.prepop)}function w(t,n,e){return t.utilprops.prepop=e||!1,t.utilprops.val!==n&&(clearTimeout(t.utilprops.timeoutID),t.utilprops.selected=null,t.utilprops.changed=!0,t.utilprops.val=n,(""===n||n.length<t.minChars)&&function(t){var n=t.input,e=n.classList;e.remove(a),e.remove(o),f(n,r,[])}(t),n.length>=t.minChars&&y(t,n,t.utilprops.debounce)),t}function A(t){var n,e=this;t.target===e.input&&(n=e.utilprops.convertInput.call(e,e.input.value),w(e,n))}function k(t,n,e){return c.create("li",{innerHTML:t,role:"option","aria-selected":"false",tabindex:"0",id:"awesomplete_list_"+this.count+"_item_"+e})}function C(t){var n,e,r=this,i=r.o,u=r.l,o=r.p;t.target===c(i)&&("function"==typeof o?o(t,u):(n=c(o))&&n!==document.activeElement&&(e=Array.isArray(t.detail)&&1===t.detail.length?t.detail[0]:null,e=(u&&e?e[u]:e)||"",void 0!==n.value?(n.value=e,n.classList&&n.classList.remove&&n.classList.remove(a)):void 0!==n.src?n.src=e:n.innerHTML=e))}function F(t){var n,e;t.target===c(this.btnId)&&(t.preventDefault(),0===(n=this.i).ul.childNodes.length||n.ul.hasAttribute("hidden")?(e=n.minChars,n.minChars=0,n.evaluate(),n.minChars=e):n.close())}function j(t,n,e){var r=c.regExpEscape(function(t){return t.replace("&","&amp;").replace("<","&lt;").replace(">","&gt;")}(n).trim()),i=""===r?null:e?RegExp("^"+r,"i"):RegExp("(?!<[^>]+?>)"+r+"(?![^<]*?>)","gi");return t.replace(i,"<mark>$&</mark>")}function O(t,n,e,r,i){var u,o=i.root,a=i.value,c=i.label||i.value,f=!0,l=[];if(0===r&&o&&e&&0!==(e+".").lastIndexOf(o+".",0)&&0!==(o+".").lastIndexOf(e+".",0))return t;if(Object(n)!==n)e?t[e]=n:t=n;else if(Array.isArray(n)){for(u=0;u<n.length;u++)l.push(O({},n[u],"",r+1,i));e?t[e]=l:t=l}else{for(u in n)f=!1,O(t,n[u],e?e+"."+u:u,r,i);f&&e&&(t[e]={})}return r<2&&e&&(a&&0===(e+".").lastIndexOf(a+".",0)&&(t.value=t[e]),c&&0===(e+".").lastIndexOf(c+".",0)&&(t.label=t[e])),0===r&&(a&&!("value"in t)&&(t.value=null),c&&!("label"in t)&&(t.label=null)),t}function g(){var t=this,r=t.i.input,i=t.h,o=t.m,a=t.v,c=t.A;r.removeEventListener(u,c),r.removeEventListener(n,i),r.removeEventListener(e,i),r.removeEventListener("blur",i),r.removeEventListener("input",o),r.removeEventListener("keydown",a)}return{ajax:function(t,n,e,r,i){var u=encodeURIComponent(e);return(i=i||new XMLHttpRequest).open("GET",t+("function"==typeof n?n(u):u+(n||""))),i.onload=r,i.send(),i},convertInput:function(t){return"string"==typeof t?t.trim().toLowerCase():""},item:k,load:m,mark:j,itemContains:function(t,n,e){var r;return""!==n.trim()&&((r=(""+t).split(/<p>/))[0]=j(r[0],n),t=r.join("<p>")),k.call(this,t,n,e)},itemMarkAll:function(t,n,e){return k.call(this,""===n.trim()?""+t:j(""+t,n),n,e)},itemStartsWith:function(t,n,e){return k.call(this,""===n.trim()?""+t:j(""+t,n,!0),n,e)},itemWords:function(t,n,e){var r,i,u=n.split(/\s+/);if(""!==n.trim()){for(r=(""+t).split("<"),i=0;i<u.length;i++)r[0]=j(r[0],u[i]);t=r.join("<")}return k.call(this,t,n,e)},create:function(t,n,e){e.item=e.item||this.itemContains;var r=new Awesomplete(t,e);return r.utilprops=n||{},r.utilprops.url||void 0!==r.utilprops.loadall||(r.utilprops.loadall=!0),r.utilprops.ajax=r.utilprops.ajax||this.ajax,r.utilprops.convertInput=r.utilprops.convertInput||this.convertInput,r},attach:function(t){var r=t.input,i=s.bind(t),o=d.bind(t),a=A.bind(t),f=p.bind(t),l=g.bind({i:t,h:i,m:a,v:o,A:f}),h={keydown:o,input:a};return h.blur=h[e]=h[n]=i,h[u]=f,c.bind(r,h),t.utilprops.detach=l,t.utilprops.prepop&&(t.utilprops.loadall||""!==r.value)&&(t.utilprops.val=t.utilprops.convertInput.call(t,r.value),y(t,t.utilprops.val)),t},update:function(t,n,e){return t.input.value=n,w(t,n,e)},start:function(t,n,e){return this.attach(this.create(t,n,e))},detach:function(t){return clearTimeout(t.utilprops.timeoutID),t.utilprops.detach&&(t.utilprops.detach(),delete t.utilprops.detach),t},createCopyFun:function(t,n,e){return C.bind({o:t,l:n,p:c(e)||e})},attachCopyFun:function(t,n,e){return n="boolean"!=typeof n||n,(e=e||document.body).addEventListener(r,t),n&&e.addEventListener(i,t),t},startCopy:function(t,n,e,r){var i=c(t);return this.attachCopyFun(this.createCopyFun(i||t,n,e),r,i)},detachCopyFun:function(t,n){return(n=n||document.body).removeEventListener(i,t),n.removeEventListener(r,t),t},createClickFun:function(t,n){return F.bind({btnId:t,i:n})},attachClickFun:function(t,n){return(n=n||document.body).addEventListener("click",t),t},startClick:function(t,n){var e=c(t);return this.attachClickFun(this.createClickFun(e||t,n),e)},detachClickFun:function(t,n){return(n=n||document.body).removeEventListener("click",t),t},filterContains:function(t,n){return Awesomplete.FILTER_CONTAINS(t.value,n)},filterStartsWith:function(t,n){return Awesomplete.FILTER_STARTSWITH(t.value,n)},filterOff:function(t,n){return!0},filterWords:function(t,n){var e,r=n.split(/\s+/),i=!0;for(t=" "+t,e=0;i&&e<r.length;e++)i=Awesomplete.FILTER_CONTAINS(t," "+r[e]);return i},jsonFlatten:function(t){return O({},t,"",0,this)}}}();"object"==typeof module&&module.exports&&(module.exports=AwesompleteUtil),"undefined"!=typeof self&&(self.AwesompleteUtil=AwesompleteUtil);
//# sourceMappingURL=awesomplete-util.min.js.map