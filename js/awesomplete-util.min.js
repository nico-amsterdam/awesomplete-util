// AwesompleteUtil - Nico Hoogervorst - MIT license
var AwesompleteUtil=function(){var t="awesomplete-",n=t+"loadcomplete",e=t+"close",r=t+"match",u=t+"prepop",i=t+"select",o="awe-found",a="awe-not-found",c=Awesomplete.$;function f(t,n,e){return c.fire(t,n,{detail:e})}function l(t,n){var e,i,c,l,s,d,p=t.input,h=p.classList,v=t.utilprops,m=v.selected,b=v.convertInput.call(t,p.value),y=t.opened,w=[],k=t._list;if(v.prepop=!1,k){for(l=0;l<k.length;l++)if(c=k[l],s=t.data(c,b),d=void 0,e={label:(d=Array.isArray(s)?{label:s[0],value:s[1]}:"object"==typeof s&&"label"in s&&"value"in s?s:{label:s,value:s}).label||d.value,value:d.value},0===t.maxItems&&(e.toString=function(){return""+this.label},t.filter(e,b)&&(y=!0)),i={input:{value:""}},t.replace.call(i,e),v.convertInput.call(t,i.input.value)===b){if(m&&m.value===e.value&&m.label===e.label){w=[c];break}w.push(c)}v.prevSelected!==w&&(w.length>0?n?f(p,u,w):v.changed&&(v.prevSelected=w,h.remove(a),h.add(o),f(p,r,w)):n?f(p,u,[]):v.changed&&(v.prevSelected=[],h.remove(o),y&&p===document.activeElement?h.remove(a):b.length>0&&(h.add(a),f(p,r,[]))))}}function s(t){var r=this;t.type!==e&&t.type!==n&&"blur"!=t.type||t.target!==r.input||l(r,r.utilprops.prepop&&t.type===n)}function d(t){t.target===this.input&&9===t.keyCode&&this.select()}function p(t){this.utilprops.changed=!0,this.utilprops.selected=t.text}function h(t,n,e){var r=t.utilprops;return!r.t||!r.loadall&&0===n.lastIndexOf(e,0)&&(0!==n.lastIndexOf(r.t,0)||"number"==typeof r.limit&&t._list.length>=r.limit)}function v(t,e,r){t.list=e,t.utilprops.t=r,f(t.input,n,r)}function m(){var t,n,e=this,r=e.u,u=e.i,i=e.queryVal,o=r.utilprops.val;if(200===u.status){if(t=JSON.parse(u.responseText),r.utilprops.convertResponse&&(t=r.utilprops.convertResponse(t)),!Array.isArray(t))if(0===r.utilprops.limit||1===r.utilprops.limit)t=function(t){return 0===Object.keys(t).length&&t.constructor===Object}(t)?[]:[t];else for(n in t)if(Array.isArray(t[n])){t=t[n];break}Array.isArray(t)&&h(r,o,i)&&v(r,t,i||r.utilprops.loadall)}}function b(t,n){var e;t.utilprops.url&&h(t,n,n)?(e=new XMLHttpRequest,t.utilprops.ajax.call(t,t.utilprops.url,t.utilprops.urlEnd,t.utilprops.loadall?"":n,m.bind({u:t,i:e,queryVal:n}),e)):l(t,t.utilprops.prepop)}function y(t,n,e){return t.utilprops.prepop=e||!1,t.utilprops.val!==n&&(t.utilprops.selected=null,t.utilprops.changed=!0,t.utilprops.val=n,(n.length<t.minChars||0==n.length)&&function(t){var n=t.input,e=n.classList;e.remove(a),e.remove(o),f(n,r,[])}(t),n.length>=t.minChars&&b(t,n)),t}function w(t){var n,e=this;t.target===e.input&&(n=e.utilprops.convertInput.call(e,e.input.value),y(e,n))}function k(t){return c.create("li",{innerHTML:t,"aria-selected":"false"})}function A(t){var n,e,r=this,u=r.o,i=r.l,o=r.p;t.target===c(u)&&("function"==typeof o?o(t,i):(n=c(o))&&n!==document.activeElement&&(e=Array.isArray(t.detail)&&1===t.detail.length?t.detail[0]:null,e=(i&&e?e[i]:e)||"",void 0!==n.value?(n.value=e,n.classList&&n.classList.remove&&n.classList.remove(a)):void 0!==n.src?n.src=e:n.innerHTML=e))}function C(t){var n,e;t.target===c(this.btnId)&&(t.preventDefault(),0===(n=this.u).ul.childNodes.length||n.ul.hasAttribute("hidden")?(e=n.minChars,n.minChars=0,n.evaluate(),n.minChars=e):n.close())}function F(t,n,e){var r=c.regExpEscape(function(t){return t.replace("&","&amp;").replace("<","&lt;").replace(">","&gt;")}(n).trim()),u=r.length<=0?null:e?RegExp("^"+r,"i"):RegExp("(?!<[^>]+?>)"+r+"(?![^<]*?>)","gi");return t.replace(u,"<mark>$&</mark>")}function j(t,n,e,r,u){var i,o=u.root,a=u.value,c=u.label||u.value,f=!0,l=[];if(0===r&&o&&e&&0!==(e+".").lastIndexOf(o+".",0)&&0!==(o+".").lastIndexOf(e+".",0))return t;if(Object(n)!==n)e?t[e]=n:t=n;else if(Array.isArray(n)){for(i=0;i<n.length;i++)l.push(j({},n[i],"",r+1,u));e?t[e]=l:t=l}else{for(i in n)f=!1,j(t,n[i],e?e+"."+i:i,r,u);f&&e&&(t[e]={})}return r<2&&e&&(a&&0===(e+".").lastIndexOf(a+".",0)&&(t.value=t[e]),c&&0===(e+".").lastIndexOf(c+".",0)&&(t.label=t[e])),0===r&&(a&&!("value"in t)&&(t.value=null),c&&!("label"in t)&&(t.label=null)),t}function g(){var t=this,r=t.u.input,u=t.h,o=t.v,a=t.m,c=t.k;r.removeEventListener(i,c),r.removeEventListener(n,u),r.removeEventListener(e,u),r.removeEventListener("blur",u),r.removeEventListener("input",o),r.removeEventListener("keydown",a)}return{ajax:function(t,n,e,r,u){return(u=u||new XMLHttpRequest).open("GET",t+encodeURIComponent(e)+(n||"")),u.onload=r,u.send(),u},convertInput:function(t){return"string"==typeof t?t.trim().toLowerCase():""},item:k,load:v,mark:F,itemContains:function(t,n){var e;return n.trim().length>0&&((e=(""+t).split(/<p>/))[0]=F(e[0],n),t=e.join("<p>")),k(t)},itemMarkAll:function(t,n){return k(""===n.trim()?""+t:F(""+t,n))},itemStartsWith:function(t,n){return k(""===n.trim()?""+t:F(""+t,n,!0))},create:function(t,n,e){e.item=e.item||this.itemContains;var r=new Awesomplete(t,e);return r.utilprops=n||{},r.utilprops.url||void 0!==r.utilprops.loadall||(r.utilprops.loadall=!0),r.utilprops.ajax=r.utilprops.ajax||this.ajax,r.utilprops.convertInput=r.utilprops.convertInput||this.convertInput,r},attach:function(t){var r=t.input,u=s.bind(t),o=d.bind(t),a=w.bind(t),f=p.bind(t),l=g.bind({u:t,h:u,v:a,m:o,k:f}),h={keydown:o,input:a};return h.blur=h[e]=h[n]=u,h[i]=f,c.bind(r,h),t.utilprops.detach=l,t.utilprops.prepop&&(t.utilprops.loadall||r.value.length>0)&&(t.utilprops.val=t.utilprops.convertInput.call(t,r.value),b(t,t.utilprops.val)),t},update:function(t,n,e){return t.input.value=n,y(t,n,e)},start:function(t,n,e){return this.attach(this.create(t,n,e))},detach:function(t){return t.utilprops.detach&&(t.utilprops.detach(),delete t.utilprops.detach),t},createCopyFun:function(t,n,e){return A.bind({o:t,l:n,p:c(e)||e})},attachCopyFun:function(t,n,e){return n="boolean"!=typeof n||n,(e=e||document.body).addEventListener(r,t),n&&e.addEventListener(u,t),t},startCopy:function(t,n,e,r){var u=c(t);return this.attachCopyFun(this.createCopyFun(u||t,n,e),r,u)},detachCopyFun:function(t,n){return(n=n||document.body).removeEventListener(u,t),n.removeEventListener(r,t),t},createClickFun:function(t,n){return C.bind({btnId:t,u:n})},attachClickFun:function(t,n){return(n=n||document.body).addEventListener("click",t),t},startClick:function(t,n){var e=c(t);return this.attachClickFun(this.createClickFun(e||t,n),e)},detachClickFun:function(t,n){return(n=n||document.body).removeEventListener("click",t),t},filterContains:function(t,n){return Awesomplete.FILTER_CONTAINS(t.value,n)},filterStartsWith:function(t,n){return Awesomplete.FILTER_STARTSWITH(t.value,n)},jsonFlatten:function(t){return j({},t,"",0,this)}}}();"object"==typeof module&&module.exports&&(module.exports=AwesompleteUtil);
//# sourceMappingURL=awesomplete-util.min.js.map